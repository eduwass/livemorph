<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LiveMorph Test</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
    }
    header {
      border-bottom: 1px solid #eee;
      padding-bottom: 20px;
      margin-bottom: 20px;
    }
    footer {
      border-top: 1px solid #eee;
      padding-top: 20px;
      margin-top: 20px;
      color: #666;
      font-size: 0.9em;
    }
    #main {
      min-height: 200px;
    }
    #events {
      background: #f5f5f5;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 10px;
      height: 300px;
      overflow-y: auto;
      margin: 20px 0;
    }
    .event {
      padding: 8px;
      margin-bottom: 8px;
      border-left: 3px solid #2962ff;
      background: white;
    }
    .event.connected {
      border-left-color: #00c853;
    }
    .event.filechange {
      border-left-color: #ff6d00;
    }
    .event.system {
      border-left-color: #5c6bc0;
    }
    pre {
      margin: 0;
      white-space: pre-wrap;
    }
  </style>
  <!-- Include Idiomorph for DOM morphing -->
  <script src="https://cdn.jsdelivr.net/npm/idiomorph@0.3.0/dist/idiomorph.min.js"></script>
  <!-- Include our LiveMorph client -->
  <script src="https://cdn.jsdelivr.net/gh/eduwass/livemorph/packages/client/livemorph.js"></script>
</head>
<body>
  <header id="header">
    <h1>LiveMorph Test Page</h1>
  </header>
  
  <div id="main">
    <p>This page is connected to the LiveMorph SSE server. Any file changes will be displayed below:</p>
    
    <div id="events"></div>
    
    <p>Try making changes to the following files to see LiveMorph in action:</p>
    <ul>
      <li><code>test.html</code> - This file will morph HTML changes</li>
      <li><code>packages/**/*.ts</code> - TypeScript files will trigger a page reload</li>
      <li><code>livemorph.config.json</code> - Config changes will be detected</li>
    </ul>
  </div>
  
  <footer id="footer">
    <p>LiveMorph Development Server - Framework-Agnostic Live DOM Morphing</p>
  </footer>
  
  <script>
    const eventsContainer = document.getElementById('events');
    
    // Create LiveMorph client with debug enabled
    const client = new LiveMorph.Client({
      server: 'http://localhost:4321',
      debug: true
    });
    
    // Add a custom event logger
    function logEvent(type, message) {
      const event = document.createElement('div');
      event.className = `event ${type}`;
      
      const timestamp = new Date().toLocaleTimeString();
      
      event.innerHTML = `
        <pre>[${timestamp}] ${type}: ${message}</pre>
      `;
      
      eventsContainer.appendChild(event);
      eventsContainer.scrollTop = eventsContainer.scrollHeight;
    }
    
    // Override the default log method to also log to our UI
    const originalLog = client.log;
    client.log = (...args) => {
      originalLog.apply(client, args);
      
      // Also log to our UI
      const message = args.slice(1).join(' ');
      logEvent('system', message);
    };
    
    // Add custom event listeners
    client.eventSource.addEventListener('connected', (e) => {
      const data = JSON.parse(e.data);
      logEvent('connected', `Connected to server: ${data.message}`);
    });
    
    client.eventSource.addEventListener('filechange', (e) => {
      const data = JSON.parse(e.data);
      logEvent('filechange', `File ${data.file} was ${data.eventType}, action: ${data.action}`);
    });
    
    // Log initial connection
    logEvent('system', 'Initializing LiveMorph client...');
  </script>
</body>
</html> 